___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "displayName": "Partnerize Standard eCommerce Tag",
  "categories": [
    "AFFILIATE_MARKETING",
    "ADVERTISING",
    "CONVERSIONS",
    "MARKETING",
    "SALES"
  ],
  "description": "This is the standard eCommerce tracking tag for Partnerize. This is used to send your purchase marketing events to Partnerize. This relates to the Google Analytics commerce tag.",
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "TAG",
  "version": 1,
  "brand": {
    "thumbnail": "data:image/png;base64,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\u003d",
    "displayName": "webmasterjunkie",
    "id": "github.com_webmasterjunkie"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "help": "This value would be provided to you by your Partnerize integration engineer.",
    "displayName": "Campaign ID",
    "simpleValueType": true,
    "name": "CampaignID",
    "type": "TEXT",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "alwaysInSummary": true
  },
  {
    "type": "LABEL",
    "name": "ParamDetails",
    "displayName": "These \"Custom Tag Values\" are what are Partnerize \"meta parameters\". The default tag will already capture items like \"conversionref\", \"category\", and \"value(s)\"."
  },
  {
    "help": "You can provide as many custom parameters to the conversion level of this event as you would like.",
    "displayName": "Custom Tag Values",
    "name": "CustomValues",
    "simpleTableColumns": [
      {
        "valueValidators": [],
        "defaultValue": "",
        "displayName": "Parameter Name",
        "name": "customParameters",
        "type": "TEXT"
      },
      {
        "defaultValue": "",
        "displayName": "Parameter Value",
        "name": "customValues",
        "type": "TEXT"
      }
    ],
    "type": "SIMPLE_TABLE"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Include the required APIs
const log = require('logToConsole');
const sendPixel = require('sendPixel');
const encodeUriComponent = require('encodeUriComponent');
const copyFromDataLayer = require('copyFromDataLayer');
const localStorage = require('localStorage');
const queryPermission = require('queryPermission');
const getCookieValues = require('getCookieValues');

const transactionId = copyFromDataLayer('transactionId');
const transactionProducts = copyFromDataLayer('transactionProducts');
const localStorageID = 'partnerizeClickReference';

// Begin setup of the tracking pixel
var url = 'https://prf.hn/conversion/tmethod:1/tplatform:4/tdetail:6/campaign:' + encodeUriComponent(data.CampaignID) + '/';

url = handleClickrefVariable(url);

// Add the order id to the pixel
if (typeof transactionId != 'undefined'){
  url = url + 'conversionref:' + encodeUriComponent(transactionId) + '/';
}

// Add the custom basket level tracking parameters
if (typeof data.CustomValues != 'undefined'){
  data.CustomValues.forEach(function(element) {
	  if (typeof element.customValues !== 'undefined'){
		  url = url + formatParameter(element.customParameters) + ':' + encodeUriComponent(element.customValues) + '/';
	  } else {
		  url = url + formatParameter(element.customParameters) + ':/';
	  }
  });
}

// Add the item level values
if (typeof transactionProducts != 'undefined'){
	url = url + createItemString(transactionProducts);
}

// Call data.gtmOnSuccess when the tag is finished.
sendPixel(url, data.gtmOnSuccess, data.gtmOnFailure);

// Enable logging for debugging purposes
log(url);
log(data);

function handleClickrefVariable(partnerize) {
  let clickref = localStorage.getItem(localStorageID);

  if (clickref != '' && clickref != null){
    partnerize = partnerize + 'clickref:' + clickref + '/';
  } else {
    clickref = getCookieValues(localStorageID);
    if (clickref[0]){
      if (partnerize.indexOf('clickref:/') !== -1){
        partnerize.replace('clickref:/', 'clickref:' + clickref[0] + '/');
      }

      if (partnerize.indexOf('clickref') === -1){
        partnerize = partnerize + 'clickref:' + clickref[0] + '/';
      }
    }
  }

  return partnerize;
}

function formatParameter(customParameters){
  var string = customParameters.replace(' ', '_');
  var regex = "/[^A-Za-z0-9_]/";

  return string.replace(regex, '', string).toLowerCase();
}

function createItemString(ecomProducts){
  var stringproducts = '';

  for (var i = 0; i < ecomProducts.length; i++){
	stringproducts = stringproducts + '[';
	for (var key in ecomProducts[i]){
      switch (key){
        case "currency": break;

        case "price":
		  // Enable logging for debugging purposes
          log('value: ' + encodeUriComponent(ecomProducts[i][key].toString()));
          stringproducts = stringproducts + 'value:' + encodeUriComponent(ecomProducts[i][key].toString()) + '/';
          break;

        default:
		  // Enable logging for debugging purposes
          if (typeof ecomProducts[i][key] !== 'undefined' && ecomProducts[i][key] !== null) {
            log(key + ': ' + encodeUriComponent(ecomProducts[i][key].toString()));
            stringproducts = stringproducts + key + ':' + encodeUriComponent(ecomProducts[i][key].toString()) + '/';
          } else {
            log(key + ': null');
            stringproducts = stringproducts + key + ':/';
          }
          break;
      }
	}

	stringproducts = stringproducts + ']';
  }

  return stringproducts;
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://prf.hn/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "transactionId"
              },
              {
                "type": 1,
                "string": "transactionProducts.*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_local_storage",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "partnerizeClickReference"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "partnerizeClickReference"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 25/10/2019, 10:49:37
